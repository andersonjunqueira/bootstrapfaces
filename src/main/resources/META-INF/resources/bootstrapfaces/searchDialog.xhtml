<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:cc="http://java.sun.com/jsf/composite"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:bf="http://www.neotech.com.br/bootstrapfaces"
    xmlns:b="http://www.neotech.com.br/bootstrapfaces">

<cc:interface componentType="neotech.bootstrapfaces.crudtable">

    <cc:attribute name="headerTitle" required="true" type="java.lang.String"/>
    <cc:attribute name="jsId" required="true" type="java.lang.String"/>

    <cc:attribute name="searchParameter" required="false" type="java.lang.String"/>
    <cc:attribute name="actionForSearch" required="false" method-signature="java.lang.String action()"/>
    <cc:attribute name="actionForClear" required="false" method-signature="java.lang.String action()"/>

    <cc:attribute name="pageSizes" required="false" default="10 25 50 100" type="java.lang.String"/>

    <cc:attribute name="value" required="true"/>
    <cc:attribute name="columnClasses" required="false"/>

    <cc:facet name="search" shortDescription="Customização da área de busca do componente" />
    <cc:facet name="footer" shortDescription="Botões extras para o rodapé do diálogo" />

</cc:interface>
<cc:implementation>

<h:panelGroup id="componente" layout="block">

    <div id="#{cc.jsId}" class="modal fade in" tabindex="-1"
        role="dialog" aria-labelledby="#{cc.jsId}Label" aria-hidden="true" 
        style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="cadastroModalLabel">#{cc.headerTitle}</h4>
                </div>

                <div class="modal-body">

                    <div class="row wrapper">
                        <div class="col-xs-5 col-sm-6 col-md-7 col-lg-6">
                            <ui:fragment rendered="#{!empty cc.facets.search}">
                                <cc:renderFacet name="search"/>
                            </ui:fragment>
                            <ui:fragment rendered="#{empty cc.facets.search}">
                                <div class="input-group">
                                    <h:inputText id="searchParamsInput" value="#{cc.attrs.searchParameter}" styleClass="form-control input-sm"
                                        placeholder="#{comps['framework.crudTable.buscar']}" />
                                    <span class="input-group-btn">
                                        <h:commandButton id="searchLink" action="#{cc.attrs.actionForSearch}" styleClass="btn btn-sm btn-default"
                                            value="#{comps['framework.crudTable.buscar']}">
                                            <f:ajax execute="searchParamsInput" render="@this resultset paginator:componente #{cc.renderOnSearch}"/>
                                        </h:commandButton>
                                        <h:commandLink id="clearLink" action="#{cc.attrs.actionForClear}" styleClass="btn btn-sm btn-default">
                                            <i class="fa fa-eraser"></i> <span class="hidden-xs">#{comps['framework.crudTable.limpar']}</span>
                                            <f:ajax execute="searchParamsInput" render="@this resultset paginator:componente #{cc.renderOnSearch}"/>
                                        </h:commandLink>
                                    </span>
                                </div>
                            </ui:fragment>
                        </div>
                        <div class="col-xs-7 col-sm-6 col-md-5 col-lg-6 m-b-xs text-right">
                            <h:selectOneMenu id="pageSizeSelect" value="#{cc.pageSize}" styleClass="form-control input-sm input-s-md inline v-middle">
                                <f:selectItems value="#{cc.pageSelectorList}" var="ps" itemValue="#{ps}" itemLabel="#{ps}"/>
                            </h:selectOneMenu>
                            <h:commandLink id="pageSizeDefine" action="#{cc.definePageSize()}" styleClass="btn btn-sm btn-default">
                                <f:ajax execute="pageSizeSelect" render="@this resultset paginator:componente"/>
                                #{comps['framework.crudTable.aplicar']}
                            </h:commandLink>
                        </div>
                    </div>

                    <h:panelGroup id="resultset" layout="block">
                        <div class="table-responsive">

                            <h:dataTable id="table" var="reg" value="#{cc.value}" 
                                styleClass="table table-striped v-middle b-t b-light"
                                columnClasses="#{cc.attrs.columnClasses}"
                                rendered="#{cc.value.size() gt 0}">
                                <cc:insertChildren/>
                            </h:dataTable>
                            <ui:fragment rendered="#{cc.value.size() eq 0}">
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
                                        <p><h:outputText value="#{comps['framework.crudTable.nenhumregistro']}"/></p>
                                    </div>
                                </div>
                            </ui:fragment> 

                        </div>

                        <bf:tablePaginator id="paginator" value="#{cc.value}" renderTarget=":#{cc.clientId}:resultset"/>

                    </h:panelGroup>

                </div>

                <div class="modal-footer">
                    <a href="#" class="btn btn-default pull-right" onclick="$('##{cc.jsId}').modal('hide');">
                        #{comps['framework.crudTable.cancelar']}
                    </a>
                    <cc:renderFacet name="footer"/>
                </div>
            </div>
        </div>
    </div>

</h:panelGroup>
</cc:implementation>
</ui:composition>